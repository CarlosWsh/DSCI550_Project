# Haunted Places Dataset Analysis - Part 1

## Group Members

- **Sihang Wang**: Project Leader, Coder, Report Quality Control
- **Kexin Fan**: Report Writing
- **Xinmeng Hu**: Report Writing
- **Sam Koog**: Report Writing
- **Tammi Sison**: Report Writing

## Introduction

This project aims to analyze the Haunted Places Dataset, which contains information about haunted locations across the United States. The dataset consists of **10,922 rows and 10 columns**, with the following attributes:

- **city**: Name of the city
- **country**: Name of the country
- **description**: Description of the haunted place
- **location**: General location details
- **state**: Name of the state
- **state_abbrev**: Abbreviation of the state
- **longitude**: Longitude coordinate

## Repository Structure
```plaintext
📂 haunted-places-analysis
├── 📄 README.md              # Project documentation
├── 📄 requirements.txt       # required libraries
├── 📄 .python-version.txt    # Pyenv version used in etllib and tika-similarity
├── 📂 data                   # Dataset and related files
├── 📂 source_code            # Analysis scripts
├── 📂 visualizations         # D3.js visualizations
├── 📂 report                 # analysis report
```

## Tools & Technologies
- **Python** (pandas,
os,
json,
requests,
tika,
number_parser,
datefinder,
beautifulsoup4,
tqdm,
transformers,
torch,
accelerate,
nltk)
- **D3.js** (Data visualization)
- **Qwen** (Qwen/Qwen2.5-1.5B-Instruct) (Natural Language Processing)
- **GitHub** (Version control)


## Special Notes
**Qwen model** needs to install tensorflow and torch libraries.

This project was tested and run separately using two different Python versions: **3.8.0** and **2.7.18**. 

- The **Qwen model** supports only Python **3.8.0**.
- The **Tika-similarity model** supports and tested only in Python **2.7.18**.

These Python versions are specified in the `.python-version.txt` file. 
To run the code, ensure you have the correct Python versions installed.


### **Installing Python Versions with Pyenv**
Use the following commands to install the required Python versions:
```sh
pyenv install 3.8.0
pyenv install 2.7.18
```
After installation, set the correct Python version:
```sh
pyenv local 3.8.0
pyenv local 2.7.18
```
Verify the Python version:
```sh
python --version
```

## Processed Data
- The **final Haunted Places TSV** file is stored at: `data/processed/haunted_analysis.tsv`.
- **Tika analysis and similarity analysis** results are stored in the `data/` folder with appropriate names.
- These files were generated from previous terminal runs, and no code is required to rerun them.

## Source Code
- `analysis_dat_witness.py`: This script uses the **Qwen model** to analyze the dataset and generate results. It takes approximately **6 hours** to run. The processed data is already stored in the `data/` folder, so **do not rerun the script**.
  - **Tested on**: RTX 4070 Super GPU.
  - If using a CPU, modify the code accordingly.
- `scrap_suno_day_night_1700.py` & `scrap_suno_day_night_1800.py`:
  - These scripts scrape **sunrise/sunset data**.
  - **Runtime**: 6 hours.
  - The processed data is saved in the `data/` folder, so **do not rerun these scripts**.

## D3.js Visualizations
- The D3.js visualizations are stored in the `visualizations/` folder.
- The stored visuliations are **static** and only for preview.
- The visualizations are **not static** and require a **local server** to run.
- To run the visualizations, use a **local server** in terminal:
  ```sh
  python -m http.server 8000 # Python 3.x
  ```
    or
    ```sh
    python -m SimpleHTTPServer 8000 # Python 2.x
    ```
- Open the browser and navigate to `http://localhost:8000/` to view the visualizations.
- Notice that only `Bar Chart`,`Force-Directed Graph` and `icicle` visualizations are interactive.

### 1️⃣ **Bar Chart**  
- **Purpose**: Displays **similarity scores** generated by the Tika model.  
- **How It Works**: Each bar represents an entity, with height corresponding to **similarity scores**.  
- **Use Case**: Helps analyze **how similar** different items are based on the model's output.  

### 2️⃣ **Force-Directed Graph**  
- **Purpose**: Visualizes the **similarity-based clustering** of entities.  
- **How It Works**:  
  - Nodes represent entities.  
  - Links represent **relationships based on similarity scores**.  
  - Nodes attract or repel based on force simulation.  
- **Use Case**: Best for **exploring relationships dynamically** and finding **clusters** of similar items.  

### 3️⃣ **Icicle Chart**  
- **Purpose**: Displays **hierarchical relationships** within clusters.  
- **How It Works**:  
  - Groups are represented as stacked rectangles.  
  - The deeper the level, the **narrower the section**, showing hierarchy.  
  - Hovering over sections highlights the group and displays a **tooltip** with details.  
- **Use Case**: Helps in understanding **nested categories and subcategories** in structured datasets.  

### 4️⃣ **Indented Tree**  
- **Purpose**: Provides a **text-based hierarchical structure** of groups.  
- **How It Works**:  
  - Each group is indented based on its hierarchy.  
  - Expanding/collapsing nodes makes it easy to **navigate large datasets**.  
- **Use Case**: Best for displaying **structured data** clearly while allowing interaction. 

## Technology References
- [Qwen Model](https://huggingface.co/Qwen/Qwen2.5-1.5B-Instruct)
- [Tika Similarity Model](https://github.com/chrismattmann/tika-similarity)
- [etllib](https://github.com/chrismattmann/etllib/tree/master/etl)
- [D3.js](https://d3js.org/)
- [D3.js Documentation](https://github.com/d3/d3?tab=readme-ov-file)